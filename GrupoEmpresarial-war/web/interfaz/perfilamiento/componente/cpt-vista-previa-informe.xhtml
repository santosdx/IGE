<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets">

    <p:panel>
        <p:tooltip />
        <h:form id="forInformeEjecutivoGrupoEmpresarial" style="width: 800px;">
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-2">&nbsp;</div>
                    <div class="ui-grid-col-8">

                        <p:outputLabel value="Seleccione el Grupos Empresariales sobre el cual va a realizar el informe Ejecutivo."/>
                        <br></br>
                        <p:selectOneMenu id="cboGrupo" value="#{MbInformeGrupoEmpresarial.idIdentificacionSeleccionada}" 
                                         filter="true" filterMatchMode="contains" >
                            <p:ajax event="change" listener="#{MbInformeGrupoEmpresarial.mySelectionMethodListener}" update="pnlFormularioInformeEjecutivoGrupo"/>
                            <f:selectItem itemLabel="Grupo Empresarial..." itemValue="" />
                            <f:selectItems value="#{MbInformeGrupoEmpresarial.listaIdentificacion}" var="grupo" itemLabel="#{grupo.nombreRegistrado}" itemValue="#{grupo.id.id}"/>
                        </p:selectOneMenu>
                        <br></br><br></br>
                        <center>
                            <h:panelGrid id="pnlFormularioInformeEjecutivoGrupo" columns="1">
                                <p:graphicImage id="imgInformeGrupo" value="/resources/imagen-reporte/encabezado-informe-ejecutivo.png" width="800"/>
                                <hr class="lineaGradian"/>
                                <h3 style="text-align: center;">#{MbInformeGrupoEmpresarial.identificacionSeleccionada.nombreRegistrado}</h3>
                                <h3 style="text-align: center;">Reseña Conglomerado</h3>
                                <hr class="lineaGradian"/>
                                <br></br>
                                <p:editor id="edtResenaConglomerado" widgetVar="editorWidget" style=" margin-left: 40px;" maxlength="1500"
                                          value="#{MbInformeGrupoEmpresarial.resenaConglomerado}" width="705"  validatorMessage="Solo se permite 1500 caracteres"
                                          onchange="handleTextChangeEdtResenaConglomerado()">
                                    <f:validateLength maximum="1500" />
                                </p:editor>
                                <p:remoteCommand name="chageEdtResenaConglomerado" process="@parent" update="lblLentResena" />
                                <p:outputLabel id="lblLentResena" style=" margin-left: 40px; color: #c0c0c4;" 
                                               value="#{MbInformeGrupoEmpresarial.resenaConglomerado.length()}/1500"/>
                                <br></br>
                                <hr class="lineaGradian"/>
                                <h3 style="text-align: center;">Información de identificación del conglomerado</h3>
                                <hr class="lineaGradian"/>
                                <h:panelGrid columns="2">
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Sector: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Nombre comercial: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.nombreComercial}"/>
                                        <p:outputLabel value="Nombre registrado: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.nombreRegistrado}"/>
                                        <p:outputLabel value="NIT: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.nit}"/>
                                        <p:outputLabel value="Departamento sede principal: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.departamento}"/>
                                        <p:outputLabel value="Dirección sede principal: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.direccion}"/>
                                        <p:outputLabel value="Teléfono sede principal: " style="font-weight: bold;"/>
                                        <p:outputLabel value="(#{MbInformeGrupoEmpresarial.identificacionSeleccionada.indicativo}) #{MbInformeGrupoEmpresarial.identificacionSeleccionada.telefonoContacto}"/>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Página web: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.paginaWeb}"/>
                                        <p:outputLabel value="Representante legal: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.representanteLegal}"/>
                                        <p:outputLabel value="Nombre de contacto: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.nombreContacto}"/>
                                        <p:outputLabel value="Cargo: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.cargoContacto}"/>
                                        <p:outputLabel value="Teléfono de contacto: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.telefonoContacto}"/>
                                        <p:outputLabel value="Correo eléctronico de contacto: " style="font-weight: bold;"/>
                                        <p:outputLabel value="#{MbInformeGrupoEmpresarial.identificacionSeleccionada.correoElectronico}"/>
                                    </h:panelGrid>
                                </h:panelGrid>
                                <br></br>
                                <hr class="lineaGradian"/>
                                <h3 style="text-align: center;">Información de estructura legal y operativa del conglomerado</h3>
                                <hr class="lineaGradian"/>
                                <h:panelGrid columns="2">
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Tipo de conglomerado: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Tipo de control: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de unidades legales: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de filiales: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de subsidiarias: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>

                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Número de Unidades Legales a nivel nacional: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de establecimientos: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Matriz: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="NIT: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="País de la matriz: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                    </h:panelGrid>
                                </h:panelGrid>
                                <br></br>
                                <hr class="lineaGradian"/>
                                <h3 style="text-align: center;">Información económica y de tamaño del conglomerado *</h3>
                                <hr class="lineaGradian"/>
                                <h:panelGrid columns="2">
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Ingresos operacionales: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Utilidad operacional: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Ebitda: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Utilidad neta: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Activos: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>

                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Pasivos: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Patrimonio: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Personal ocupado en Colombia: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de hombres ocupados: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de mujeres ocupadas: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                    </h:panelGrid>
                                </h:panelGrid>
                                <br></br>
                                <hr class="lineaGradian"/>
                                <h3 style="text-align: center;">Información económica y de tamaño del conglomerado *</h3>
                                <hr class="lineaGradian"/>
                                <h:panelGrid columns="2">
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Fecha de configuración del grupo: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de unidades legales creadas: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de unidades legales que cerraron: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de unidades legales liquidadas: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>

                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <p:outputLabel value="Número de establecimientos creados: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de establecimientos que cerraron: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                        <p:outputLabel value="Número de establecimientos liquidados: " style="font-weight: bold;"/>
                                        <p:outputLabel value=""/>
                                    </h:panelGrid>
                                </h:panelGrid>
                                <hr class="lineaGradian"/>
                                <h3 style="text-align: center;">Análisis del conglomerado</h3>
                                <hr class="lineaGradian"/>
                                <br></br>
                                <p:editor id="edtAnalisis1Conglomerado" widgetVar="editorWidget" style=" margin-left: 40px;" maxlength="1500"
                                          value="#{MbInformeGrupoEmpresarial.resenaConglomerado}" width="705"  validatorMessage="Solo se permite 1500 caracteres"
                                          onchange="handleTextChangeEdtAnalisis1Conglomerado()">
                                    <f:validateLength maximum="1500" />
                                </p:editor>
                                <p:remoteCommand name="chageEdtAnalisis1Conglomerado" process="@parent" update="lblLentAnalisis1" />
                                <p:outputLabel id="lblLentAnalisis1" style=" margin-left: 40px; color: #c0c0c4;" 
                                               value="#{MbInformeGrupoEmpresarial.resenaConglomerado.length()}/1500"/>
                                <br></br><br></br>
                                <p:graphicImage value="#{MbInformeGrupoEmpresarial.chart}"/>
                                <h:panelGrid columns="3" >
                                    <p:spacer />
                                    <p:chart id="chrDepartamento" widgetVar="wVchrDepartamento" type="pie" style="width:500px;height:350px" 
                                             model="#{MbInformeGrupoEmpresarial.pieModeUnidadLegalDepartamento}" />
                                    <h:inputHidden id="b64" value="#{MbInformeGrupoEmpresarial.base64Str}" />
                                </h:panelGrid>
                                <p:commandButton id="exp" value="Export" icon="ui-icon-extlink"
                                                 onclick="exportChart();"
                                                 actionListener="#{MbInformeGrupoEmpresarial.submittedBase64Str}" />
                                <br></br><br></br>
                                <p:commandButton id="btnDescargarReporteGrupoEmpresa" value="Descargar" ajax="false"  style="float: right;"
                                                 actionListener="#{MbInformeGrupoEmpresarial.generarInformeEjecutivoGrupoEmpresarialPdf}"
                                                 onclick="PrimeFaces.monitorDownload(start, stop);" icon="ui-icon-arrowthick-1-s">
                                    <p:fileDownload value="#{MbInformeGrupoEmpresarial.contenido}" />
                                </p:commandButton>
                            </h:panelGrid>
                        </center>
                    </div>
                    <div class="ui-grid-col-2">&nbsp;</div>
                </div>
            </div>

        </h:form>
    </p:panel>

    <script type="text/javascript">
        function handleTextChangeEdtResenaConglomerado()
        {
            editorText = document.getElementById("forInformeEjecutivoGrupoEmpresarial:edtResenaConglomerado_input").value;
            //alert(editorText);
            //Este es un p:remoteCommand en la vista que permite actualizar el label que visualiza el conteo de caractares
            //del componente p:editor que captura la Reseña del Conglomerado
            chageEdtResenaConglomerado();
        }
        function handleTextChangeEdtAnalisis1Conglomerado()
        {
            editorText = document.getElementById("forInformeEjecutivoGrupoEmpresarial:edtAnalisis1Conglomerado_input").value;
            //alert(editorText);
            //Este es un p:remoteCommand en la vista que permite actualizar el label que visualiza el conteo de caractares
            //del componente p:editor que captura la Reseña del Conglomerado
            chageEdtAnalisis1Conglomerado();
        }
        function exportChart() {
            // exportAsImage() will return a base64 png encoded string
            img = PF('wVchrDepartamento').exportAsImage()
            document.getElementById('forInformeEjecutivoGrupoEmpresarial:b64').value = img.src;
        }
    </script>
</ui:composition>